const express = require('express');
const app = express();
const { Document, Packer, Paragraph } = require('docx');

// Endpoint to handle download request
app.get('/download-resume', (req, res) => {
    try {
        // Generate resume document
        const doc = new Document();
        doc.addSection({
            properties: {},
            children: [
                new Paragraph('Your Resume Content Here...'),
            ],
        });

        // Create a buffer to store the document
        const buffer = Packer.toBuffer(doc);

        // Set the response headers
        res.setHeader('Content-Disposition', 'attachment; filename="resume.docx"');
        res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');

        // Send the buffer as the response
        res.send(buffer);
    } catch (error) {
        console.error('Error generating resume:', error);
        res.status(500).send('Error generating resume');
    }
});

// Start the server
app.listen(3000, () => {
    console.log('Server is running on port 3000');
});
